# SubterraneanRose Core Module
find_package(SDL2 CONFIG REQUIRED)
find_package(sdl2-mixer CONFIG REQUIRED)
find_package(sdl2-image CONFIG REQUIRED)

aux_source_directory(./src core_src_list)
# Generate GIT information in C source
include(SRoseGitInfo)
set(git_avail FALSE)
sr_gitinfo_avail(git_avail)
message(STATUS "Git: ${git_avail} ${git_found}")
if(${git_avail})
    sr_abbr_commit_id(commit_id_abbr)
else()
    set(commit_id_abbr "(Git is unavailable)")
endif()

message(STATUS "Git commit id (abbr): ${commit_id_abbr}")
string(CONCAT git_info
    "/*File generated by source/sys/CMakeLists.txt */\n"
    "const char* sr_git_commit_id_short=\"${commit_id_abbr}\"\;\n"
)
file(
    WRITE ${CMAKE_CURRENT_BINARY_DIR}/git_info.c
    ${git_info}
)
add_library("srose-core" STATIC ${core_src_list} ${CMAKE_CURRENT_BINARY_DIR}/git_info.c)
target_include_directories("srose-core" PUBLIC ./include)

target_link_libraries("srose-core" PUBLIC SDL2::SDL2)
target_link_libraries("srose-core" PUBLIC SDL2::SDL2_mixer)
target_link_libraries("srose-core" PUBLIC SDL2::SDL2_image)
